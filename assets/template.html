<!DOCTYPE html>
<html lang="zh">
	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>PROJECT_AUDIT_STRICT_v2</title>
		<script src="https://cdn.tailwindcss.com"></script>
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css">
		<script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
		<style>
			@import url('https://fonts.googleapis.com/css2?family=Inter:wght@900&family=JetBrains+Mono:wght@500&display=swap');
			body { background-color: #000; color: #fff; font-family: 'Inter', sans-serif; overflow: hidden; }
			.mono { font-family: 'JetBrains Mono', monospace; }
			.huge-title { font-size: 18vw; line-height: 0.8; font-weight: 900; letter-spacing: -0.05em; }
			.label-red { background: #FF3E3E; color: #000; padding: 2px 6px; font-size: 10px; font-weight: 900; }
			.swiper-slide { height: 100vh; display: flex; flex-col; justify-content: center; overflow: hidden; }
			.data-border { border-left: 8px solid #FF3E3E; padding-left: 1.5rem; }
			.desc-text { color: #888; font-size: 0.85rem; line-height: 1.4; }
			/* 强制隐藏图表坐标轴背景 */
			.chart-container { height: 250px; width: 100%; }
		</style>
	</head>
	<body>

		<div class="swiper">
			<div class="swiper-wrapper" id="content-mount">
			</div>
		</div>

		<script>
			const repoData = {REPO_DATA};
			
			// 模块定义：10 个分析维度
			const modules = [
			{
				id: "01", title: "SYSTEM<br>IDENTITY", color: "bg-black",
				main: repoData.project_metadata.total_commits, sub: "COMMIT_EVENTS",
				desc: `审计起点：${repoData.project_metadata.generated_at}。当前系统快照包含自 ${new Date(repoData.project_metadata.time_range.start * 1000).toLocaleDateString()} 以来的完整变更轨迹。`
				},
				{
					id: "02", title: "ENGINEERING<br>MASS", color: "bg-[#111]",
					main: repoData.workload_stats.net_lines, sub: "NET_CODE_LINES",
					desc: `质量负载：${repoData.workload_stats.total_insertions} 注入 / ${repoData.workload_stats.total_deletions} 移除。系统净增量反映了开发初期的快速扩张特征。`
					},
					{
						id: "03", title: "REFACTOR<br>INDEX", color: "bg-[#FF3E3E]", textColor: "text-black",
						main: (repoData.workload_stats.refactor_ratio * 100).toFixed(0) + "%", sub: "REFACTOR_WEIGHT",
						desc: "逻辑演进：重构比率代表了对既有债务的清理频率。当前数值显示开发更倾向于功能堆叠而非结构优化。"
						},
						{
							id: "04", title: "CONTRIBUTOR<br>ROSTER", color: "bg-black",
							main: repoData.author_leaderboard.length, sub: "ACTIVE_AUTHORS",
							desc: `权限分布：核心开发者 ${repoData.author_leaderboard[0].name}。Bus Factor 值为 ${repoData.project_metadata.bus_factor}，系统高度依赖核心单点。`
							},
							{
								id: "05", title: "IMPACT<br>SCORE", color: "bg-white", textColor: "text-black",
								main: repoData.author_leaderboard[0].impact_score, sub: "MAX_INFLUENCE",
								desc: `个体审计：基于活跃天数 (${repoData.author_leaderboard[0].active_days}) 与提交频率生成的综合影响力指标。`
								},
								{
									id: "06", title: "TEMPORAL<br>DENSITY", color: "bg-black",
									chart: "hourChart", sub: "ACTIVITY_DISTRIBUTION",
									desc: "时空规律：系统活动在 24 小时周期内的分布密度。用于识别研发节律与协作瓶颈。"
									},
									{
										id: "07", title: "VOLATILE<br>ENTITIES", color: "bg-[#111]",
										list: repoData.file_system_analysis.hotspots.slice(0, 3), sub: "HOTSPOT_FILES",
										desc: "热点分析：以下实体承受了最高频次的原子变更，是系统逻辑最不稳定的区域。"
										},
										{
											id: "08", title: "INTERFACE<br>STABILITY", color: "bg-black",
											main: repoData.engineering_quality.avg_files_per_commit.toFixed(1), sub: "FILE_COUPLING_AVG",
											desc: "耦合度审计：平均每次事件影响的文件数。数值越高，模块间的逻辑粘连越严重。"
											},
											{
												id: "09", title: "SECURITY<br>STATUS", color: "bg-[#FF3E3E]", textColor: "text-black",
												main: repoData.engineering_quality.gpg_signed_percentage + "%", sub: "GPG_VERIFIED",
												desc: "信誉验证：提交签名的覆盖率。当前数值指示了项目在分布式协作中的身份溯源安全性。"
												},
												{
													id: "10", title: "AUDIT<br>COMPLETE", color: "bg-white", textColor: "text-black",
													main: "2025", sub: "END_OF_REPORT",
													desc: "审计终点：所有已知事件已完成向量化。报告生成于本地时区 " + repoData.project_metadata.local_timezone
												}
												];
												
												// 渲染函数
												const mount = document.getElementById('content-mount');
												mount.innerHTML = modules.map(m => `
												<div class="swiper-slide p-8 ${m.color} ${m.textColor || 'text-white'} flex flex-col justify-center">
												<div class="mb-4"><span class="label-red ${m.textColor === 'text-black' ? 'bg-black text-white' : ''}">AUDIT_PHASE_${m.id}</span></div>
												<div class="huge-title mb-6">${m.title}</div>
												
												${m.main ? `<div class="data-border mb-6">
												<div class="text-6xl font-black">${m.main}</div>
												<div class="text-[10px] opacity-50 mono tracking-tighter">${m.sub}</div>
												</div>` : ''}
												
												${m.chart ? `<div id="${m.chart}" class="chart-container mb-6"></div>` : ''}
												
												${m.list ? `<div class="space-y-4 mb-6">
												${m.list.map(f => `
												<div class="border-b border-current pb-1">
												<div class="text-[10px] opacity-50 mono">${f.change_count} UPDATES</div>
												<div class="text-xs font-bold truncate">${f.path}</div>
												</div>
												`).join('')}
												</div>` : ''}
												
												<p class="desc-text ${m.textColor === 'text-black' ? 'text-black opacity-70' : ''}">${m.desc}</p>
												</div>
												`).join('');
												
												// 初始化交互
												const swiper = new Swiper('.swiper', {
													direction: 'vertical',
													mousewheel: true,
													speed: 700,
													on: {
														slideChangeTransitionEnd: function() {
															if (modules[this.activeIndex].chart) renderTemporalChart();
														}
													}
													});
													
													function renderTemporalChart() {
														const chart = echarts.init(document.getElementById('hourChart'), 'dark');
														const hours = repoData.temporal_trends.hourly_distribution;
														chart.setOption({
															backgroundColor: 'transparent',
															xAxis: { type: 'category', data: Object.keys(hours), axisLine: {show:false}, axisTick: {show:false} },
															yAxis: { show: false },
															grid: { top: 10, bottom: 20, left: 0, right: 0 },
															series: [{
																data: Object.values(hours), type: 'bar',
																itemStyle: { color: '#FF3E3E' }
																}]
																});
															}
															
															window.onload = () => { if(modules[0].chart) renderTemporalChart(); };
		</script>
	</body>
</html>
